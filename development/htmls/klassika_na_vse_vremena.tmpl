<!DOCTYPE html>
<html lang="ru">
<head>
	@@include('scaff/layout__meta-tags.html')
	@@include('scaff/layout__css-list.html')


	<title>Классика на все времена</title>


	<!-- здесь подключай свои стили -->
	<!-- НАПРИМЕР: <link rel="stylesheet" href="css/catalog.min.css"> -->
</head>
<body>
	<div class="page">
		<header class="page__header">
			@@include('scaff/layout__header.html')
		</header>


		<main class="page__content">
			
			<div class="section">
				<div class="promo-page">
					
					<!-- баннер -->
					<div class="promo-page__banner">
						<div class="section__inner">
							
							<!-- таймер -->
							<div class="promo-page__banner-timer">
								<div class="promo-page__banner-timer-title">
									До розыгрыша <br>призов осталось:
								</div>

							</div>


							<div class="countdown">
								<div class="bloc-time days" data-init-value="15">
									<div class="figure days days-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>

									<div class="figure days days-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Дней</span>
								</div>

								<div class="bloc-time hours" data-init-value="00">
									<div class="figure hours hours-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>        
									</div>

									<div class="figure hours hours-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Часов</span>
								</div>

								<div class="bloc-time min" data-init-value="00">
									<div class="figure min min-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>          
									</div>

									<div class="figure min min-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Минут</span>
								</div>

								<div class="bloc-time sec" data-init-value="00">
									<div class="figure sec sec-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>          
									</div>

									<div class="figure sec sec-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Секунд</span>
								</div>
							</div>
							
								

							<!-- видео -->
							<div class="promo-page__banner-video">
								<table>
									<tr>
										<td class="top-left"></td>
										<td class="top-center"></td>
										<td class="top-right"></td>
									</tr>
									<tr>
										<td class="left-center"></td>
										<td class="center-content">
											<iframe width="100%" src="https://www.youtube.com/embed/IdSWNCx19TY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
										</td>
										<td class="right-center"></td>
									</tr>
									<tr>
										<td class="bottom-left"></td>
										<td class="bottom-center"></td>
										<td class="bottom-right"></td>
									</tr>
								</table>
							</div>

						</div>
					</div>

				</div>
			</div>

		</main>


		<footer class="page__footer">
			@@include('scaff/layout__footer.html')
		</footer>
	</div>

	@@include('scaff/layout__js-list.html')

	<script>

		var dt = new Date();
		//var time = "Date: " + dt.getDate() + "Day: " + dt.getDay() + " - " + dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
		var currentDay   = dt.getDate();
		var currentHour  = dt.getHours();
		var currentMin   = dt.getMinutes();
		var currentSec   = dt.getSeconds();

		var finishDay    = 10; // 22 февраля

		$('.bloc-time.days').attr('data-init-value',finishDay - currentDay - 1);
		$('.bloc-time.hours').attr('data-init-value', 23 - currentHour);
		$('.bloc-time.min').attr('data-init-value', 59 - currentMin);
		$('.bloc-time.sec').attr('data-init-value', 59 - currentSec);

		//console.log(time);

			// Create Countdown
		var Countdown = {
		  
		  // Backbone-like structure
		  $el: $('.countdown'),
		  
		  // Params
		  countdown_interval: null,
		  total_seconds     : 0,
		  
		  // Initialize the countdown  
		  init: function() {
		    
		    // DOM
			this.$ = {
				days   : this.$el.find('.bloc-time.days .figure'),
		    	hours  : this.$el.find('.bloc-time.hours .figure'),
		    	minutes: this.$el.find('.bloc-time.min .figure'),
		    	seconds: this.$el.find('.bloc-time.sec .figure')
		   	};

		    // Init countdown values
		    this.values = {
		    	days   : this.$.days.parent().attr('data-init-value'),
			    hours  : this.$.hours.parent().attr('data-init-value'),
		        minutes: this.$.minutes.parent().attr('data-init-value'),
		        seconds: this.$.seconds.parent().attr('data-init-value')
		    };
		    
		    // Initialize total seconds
		    this.total_seconds = 
		    (this.values.days * 60 * 60 * 24)  
		    + (this.values.hours * 60 * 60) 
		    + (this.values.minutes * 60) 
		    + this.values.seconds;

		    // Animate countdown to the end 
		    this.count();    
		  },
		  
		  count: function() {
		    
		    var that    = this,
		    	$days_1 = this.$.days.eq(0),
		        $days_2 = this.$.days.eq(1),
		        $hour_1 = this.$.hours.eq(0),
		        $hour_2 = this.$.hours.eq(1),
		        $min_1  = this.$.minutes.eq(0),
		        $min_2  = this.$.minutes.eq(1),
		        $sec_1  = this.$.seconds.eq(0),
		        $sec_2  = this.$.seconds.eq(1);
		    
		        this.countdown_interval = setInterval(function() {

			        if(that.total_seconds > 0) {

			            --that.values.seconds;              

			            if(that.values.minutes >= 0 && that.values.seconds < 0) {

			                that.values.seconds = 59;
			                --that.values.minutes;
			            }

			            if(that.values.hours >= 0 && that.values.minutes < 0) {

			                that.values.minutes = 59;
			                --that.values.hours;
			            }

			            if(that.values.days >= 0 && that.values.hours < 0) {

			                that.values.hours = 23;
			                --that.values.days; 
			            }

			            // Update DOM values

			            // Days
			            that.checkHour(that.values.days, $days_1, $days_2);

			            // Hours
			            that.checkHour(that.values.hours, $hour_1, $hour_2);

			            // Minutes
			            that.checkHour(that.values.minutes, $min_1, $min_2);

			            // Seconds
			            that.checkHour(that.values.seconds, $sec_1, $sec_2);

			            --that.total_seconds;
			        }
			        else {
			            clearInterval(that.countdown_interval);
			        }
		    	}, 1000);    
		  },
		  
		  animateFigure: function($el, value) {
		    
		     var that         = this,
				 $top         = $el.find('.top'),
		         $bottom      = $el.find('.bottom'),
		         $back_top    = $el.find('.top-back'),
		         $back_bottom = $el.find('.bottom-back');

		    // Before we begin, change the back value
		    $back_top.find('span').html(value);

		    // Also change the back bottom value
		    $back_bottom.find('span').html(value);

		    // Then animate
		    TweenMax.to($top, .9, {
		        rotationX           : '-180deg',
		        transformPerspective: 300,
			      ease                : Quart.easeOut,
		        onComplete          : function() {

		            $top.html(value);

		            $bottom.html(value);

		            TweenMax.set($top, { rotationX: 0 });
		        }
		    });

		    TweenMax.to($back_top, .9, { 
		        rotationX           : 0,
		        transformPerspective: 300,
			      ease                : Quart.easeOut, 
		        clearProps          : 'all' 
		    });    
		  },
		  
		  checkHour: function(value, $el_1, $el_2) {
		    
		    var val_1       = value.toString().charAt(0),
		        val_2       = value.toString().charAt(1),
		        fig_1_value = $el_1.find('.top').html(),
		        fig_2_value = $el_2.find('.top').html();

		    if(value >= 10) {

		        // Animate only if the figure has changed
		        if(fig_1_value !== val_1) this.animateFigure($el_1, val_1);
		        if(fig_2_value !== val_2) this.animateFigure($el_2, val_2);
		    }
		    else {

		        // If we are under 10, replace first figure with 0
		        if(fig_1_value !== '0') this.animateFigure($el_1, 0);
		        if(fig_2_value !== val_1) this.animateFigure($el_2, val_1);
		    }    
		  }
		};

		// Let's go !
		Countdown.init();
		
	</script>
</body>
</html>